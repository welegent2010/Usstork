import{a as S,r as k,b as f,k as b,l as w,o as u,d as p,e as t,w as F,f as a,v as d,t as n,g as v}from"./index-a860f218.js";import{u as T}from"./trades-d5360864.js";const U={class:"max-w-2xl mx-auto"},V={class:"card"},D={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},I={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},$={key:0,class:"bg-gray-50 p-4 rounded-lg"},C={class:"space-y-1 text-sm"},q={class:"flex justify-between"},A={class:"flex justify-between"},M={class:"flex justify-between font-medium border-t pt-1"},h={key:1,class:"text-danger text-sm"},j={class:"flex space-x-4"},B=["disabled"],E={__name:"AddTrade",setup(L){const c=T(),x=S(),s=k({code:"",price:"",shares:"",date:new Date().toISOString().split("T")[0],fee:8}),i=f(!1),l=f(""),m=b(()=>(parseFloat(s.price)||0)*(parseInt(s.shares)||0)),y=b(()=>m.value+(parseFloat(s.fee)||0)),g=async()=>{if(!s.code||!s.price||!s.shares){l.value="请填写所有必填字段";return}if(parseFloat(s.price)<=0||parseInt(s.shares)<=0){l.value="价格和股数必须大于0";return}i.value=!0,l.value="";try{const o=await c.addTrade({code:s.code.toUpperCase(),price:parseFloat(s.price),shares:parseInt(s.shares),date:s.date,fee:parseFloat(s.fee)});o.success?x.push("/"):l.value=o.error}catch{l.value="添加交易失败，请重试"}finally{i.value=!1}};return w(()=>{s.date=new Date().toISOString().split("T")[0]}),(o,e)=>(u(),p("div",U,[t("div",V,[e[16]||(e[16]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-6"},"添加交易记录",-1)),t("form",{onSubmit:F(g,["prevent"]),class:"space-y-6"},[t("div",null,[e[7]||(e[7]=t("label",{for:"code",class:"block text-sm font-medium text-gray-700 mb-2"}," 股票代码 ",-1)),a(t("input",{id:"code","onUpdate:modelValue":e[0]||(e[0]=r=>s.code=r),type:"text",required:"",class:"form-input",placeholder:"例如：AAPL, TSLA, MSFT",onInput:e[1]||(e[1]=r=>s.code=s.code.toUpperCase())},null,544),[[d,s.code]])]),t("div",D,[t("div",null,[e[8]||(e[8]=t("label",{for:"price",class:"block text-sm font-medium text-gray-700 mb-2"}," 买入价格 (USD) ",-1)),a(t("input",{id:"price","onUpdate:modelValue":e[2]||(e[2]=r=>s.price=r),type:"number",step:"0.01",required:"",class:"form-input",placeholder:"0.00"},null,512),[[d,s.price,void 0,{number:!0}]])]),t("div",null,[e[9]||(e[9]=t("label",{for:"shares",class:"block text-sm font-medium text-gray-700 mb-2"}," 股数 ",-1)),a(t("input",{id:"shares","onUpdate:modelValue":e[3]||(e[3]=r=>s.shares=r),type:"number",required:"",class:"form-input",placeholder:"0",min:"1"},null,512),[[d,s.shares,void 0,{number:!0}]])])]),t("div",I,[t("div",null,[e[10]||(e[10]=t("label",{for:"date",class:"block text-sm font-medium text-gray-700 mb-2"}," 交易日期 ",-1)),a(t("input",{id:"date","onUpdate:modelValue":e[4]||(e[4]=r=>s.date=r),type:"date",required:"",class:"form-input"},null,512),[[d,s.date]])]),t("div",null,[e[11]||(e[11]=t("label",{for:"fee",class:"block text-sm font-medium text-gray-700 mb-2"}," 手续费 (USD) ",-1)),a(t("input",{id:"fee","onUpdate:modelValue":e[5]||(e[5]=r=>s.fee=r),type:"number",step:"0.01",class:"form-input",placeholder:"8.00"},null,512),[[d,s.fee,void 0,{number:!0}]])])]),s.price&&s.shares?(u(),p("div",$,[e[15]||(e[15]=t("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"交易摘要",-1)),t("div",C,[t("div",q,[e[12]||(e[12]=t("span",null,"股票总价:",-1)),t("span",null,"$"+n(m.value.toFixed(2)),1)]),t("div",A,[e[13]||(e[13]=t("span",null,"手续费:",-1)),t("span",null,"$"+n(s.fee.toFixed(2)),1)]),t("div",M,[e[14]||(e[14]=t("span",null,"总成本:",-1)),t("span",null,"$"+n(y.value.toFixed(2)),1)])])])):v("",!0),l.value?(u(),p("div",h,n(l.value),1)):v("",!0),t("div",j,[t("button",{type:"button",onClick:e[6]||(e[6]=r=>o.$router.push("/")),class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"}," 取消 "),t("button",{type:"submit",disabled:i.value,class:"btn-primary flex-1"},n(i.value?"添加中...":"添加交易"),9,B)])],32)])]))}};export{E as default};
