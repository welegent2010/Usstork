localStorage.getItem("alphaVantageKey");const o=t=>{if(!t)return"";let e=String(t).toUpperCase().trim();return e=e.replace(/\s+/g,""),e=e.replace(/(?:\.|-|:|\/)?US$/,""),e},c="https://www.alphavantage.co/query",s=async t=>{try{const e=localStorage.getItem("alphaVantageKey")||"demo",r=o(t),a=await(await fetch(`${c}?function=GLOBAL_QUOTE&symbol=${r}&apikey=${e}`)).json();return a["Global Quote"]&&a["Global Quote"]["05. price"]?{success:!0,price:parseFloat(a["Global Quote"]["05. price"]),change:parseFloat(a["Global Quote"]["09. change"]),changePercent:a["Global Quote"]["10. change percent"]}:{success:!0,price:Math.random()*200+50,change:(Math.random()-.5)*10,changePercent:`${(Math.random()-.5)*5}%`,mock:!0}}catch(e){return console.error("Error fetching stock quote:",e),{success:!0,price:Math.random()*200+50,change:(Math.random()-.5)*10,changePercent:`${(Math.random()-.5)*5}%`,mock:!0}}},l=t=>{localStorage.setItem("alphaVantageKey",t)},g=()=>localStorage.getItem("alphaVantageKey");export{s as a,g,l as s};
